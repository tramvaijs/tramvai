"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3303],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return m}});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=a.createContext({}),c=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},s=function(e){var n=c(e.components);return a.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=c(t),m=r,f=d["".concat(p,".").concat(m)]||d[m]||u[m]||i;return t?a.createElement(f,o(o({ref:n},s),{},{components:t})):a.createElement(f,o({ref:n},s))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=d;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=t[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},3457:function(e,n,t){t.r(n),t.d(n,{assets:function(){return p},contentTitle:function(){return o},default:function(){return u},frontMatter:function(){return i},metadata:function(){return l},toc:function(){return c}});var a=t(7462),r=(t(7294),t(3905));const i={title:"Duplicate dependencies"},o=void 0,l={unversionedId:"mistakes/duplicate-dependencies",id:"mistakes/duplicate-dependencies",title:"Duplicate dependencies",description:"Duplicated dependencies are a common problem for JavaScript projects that use npm or yarn to manage packages. They occur when two or more versions of the same package appears in dependencies tree due the way package managers create node_modules folder on the disk.",source:"@site/tmp-docs/mistakes/duplicate-dependencies.md",sourceDirName:"mistakes",slug:"/mistakes/duplicate-dependencies",permalink:"/docs/mistakes/duplicate-dependencies",draft:!1,editUrl:"https://github.com/tramvaijs/tramvai/-/edit/master/docs/tmp-docs/mistakes/duplicate-dependencies.md",tags:[],version:"current",frontMatter:{title:"Duplicate dependencies"},sidebar:"sidebar",previous:{title:"Other errors",permalink:"/docs/mistakes/other-errors"},next:{title:"Memory leak",permalink:"/docs/mistakes/memory-leak"}},p={},c=[{value:"Why is it a problem?",id:"why-is-it-a-problem",level:2},{value:"How to solve",id:"how-to-solve",level:2},{value:"Tramvai DedupePlugin for webpack",id:"tramvai-dedupeplugin-for-webpack",level:3},{value:"Using package manager",id:"using-package-manager",level:3},{value:"npm",id:"npm",level:4},{value:"yarn v1",id:"yarn-v1",level:4}],s={toc:c};function u(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Duplicated dependencies are a common problem for JavaScript projects that use npm or yarn to manage packages. They occur when two or more versions of the same package appears in dependencies tree due the way package managers create ",(0,r.kt)("inlineCode",{parentName:"p"},"node_modules")," folder on the disk."),(0,r.kt)("h2",{id:"why-is-it-a-problem"},"Why is it a problem?"),(0,r.kt)("p",null,"Duplicated dependencies can cause several issues for your project, such as:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Increasing the size of your bundles and slowing down your page loading time"),(0,r.kt)("li",{parentName:"ul"},"Increasing time of installing and updating dependencies locally and in CI"),(0,r.kt)("li",{parentName:"ul"},"Causing conflicts and errors when different versions of the same package are used in different parts of your code"),(0,r.kt)("li",{parentName:"ul"},"Breaking the rules of hooks if you have more than one copy of singleton library (like React) in your app"),(0,r.kt)("li",{parentName:"ul"},"Making it harder to maintain and update your dependencies")),(0,r.kt)("h2",{id:"how-to-solve"},"How to solve"),(0,r.kt)("h3",{id:"tramvai-dedupeplugin-for-webpack"},"Tramvai DedupePlugin for webpack"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Plugin is enabled by default when using @tramvai/cli")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/docs/references/libs/webpack-dedupe-plugin"},"webpack-dedupe-plugin")," can automatically resolve most of the duplicate dependencies issues that are related to generated bundle. And you can even try different strategies of this plugin to generate even smaller bundles."),(0,r.kt)("p",null,"After build when plugin is enabled it will show the info about packages that were deduplicated."),(0,r.kt)("h3",{id:"using-package-manager"},"Using package manager"),(0,r.kt)("h4",{id:"npm"},"npm"),(0,r.kt)("p",null,"To investigate if specific dependency is duplicated and why, use next command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"npm ls <dep_name>\n")),(0,r.kt)("p",null,"To execute deduplication of dependencies tree run next command in the root of your project (where package-lock.json file resides):"),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"This command can run for a really long time (more than 20 minutes)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"npm dedupe\n")),(0,r.kt)("h4",{id:"yarn-v1"},"yarn v1"),(0,r.kt)("p",null,"To investigate if specific dependency is duplicated and why, use next command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"yarn why <dep_name>\n")),(0,r.kt)("p",null,"To deduplicate the whole dependecies tree use separate tool ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/search?q=yarn-deduplicate"},"yarn-deduplicate")," in the root of your project (where yarn.lock file resides)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"npx yarn-deduplicate\n")))}u.isMDXComponent=!0}}]);