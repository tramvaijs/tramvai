This website was created with [Docusaurus](https://docusaurus.io/).

## Установка

Установить зависимости

```bash
yarn
```

Сгенерировать документацию. Так как у нас документация расположена по отдельным директориям, документацию необходимо сначала собрать для докариуса

```bash
yarn setup
```

## Разработка

### Запуск в development режиме

> В этом режиме не работает поиск!

Сначала выполнить этапы с блока Установка, далее команда:

```bash
yarn start
```

После каждых изменений документации, необходимо выполнить команду `yarn setup`.

### Запуск в production режиме

Сначала выполнить этапы с блока Установка, далее команда:

```bash
yarn build
```

Затем запустить сервер:

```bash
yarn serve
```

## Explanation

Основные разделы документации расположены в папке `docs` в корне репозитория.
Скрипт `yarn setup` копирует файлы документации со всего репозитория в папку `tools/docSite/tmp-docs`.
Для файлов из папки `docs`, при копировании сохраняются пути и названия.
Для документации к библиотекам (папки `packages/*` и `tools/*`) применяются более сложные преобразования, все они попадают в поддиректорию `tmp-docs/references`.

Конфигурация бокового меню документации расположена в файле `tools/docSite/sidebars.js`, большая часть меню [генерируется автоматически](https://docusaurus.io/docs/sidebar/autogenerated), на основе файловой структуры папки `tools/docSite/tmp-docs`.

### References

В случае одного `README.md` файла с документацией для пакета, например `packages/modules/common/README.md`, этот файл будет скопирован по пути `tools/docSite/tmp-docs/references/modules/common.md`.

Если хочется разбить документацию к пакету на несколько файлов, надо соблюдать следующие соглашения:

- В корне пакета создать файл `_category_.json` с заголовком категории

    ```json title="_category_.json"
    {
        "label": "@tramvai/module-common"
    }
    ```

- Хранить файлы документации в папке `docs`

    ```
    packages/modules/common
    ├── docs
        ├── first.md
        └── second.md
    ├── _category_.json
    └── README.md
    ```

На основе этого будет сгенерирована документация со следующей структурой:

```
tools/docSite/tmp-docs/references/modules/common
├── base.md
├── first.md
├── second.md
└── _category_.json
```

## How to

### Блоки с кодом

#### Установка зависимостей

Для оформления блоков с использованием команд пакетного менеджера, используейте плагин `npm2yarn`:

    ```bash npm2yarn
    npm install @tramvai/core
    ```

#### Выделение действий для пользователя

Для выделения действий в гайдах и туториалах, можно использовать emoji :hourglass:, например:

```
:hourglass: Установите пакет `@tramvai/core`
```

#### Подсветка строк и названия файлов

В блоках кода можно подсвечивать строки, и задавать название файла, подробнее в [документации docusaurus](https://docusaurus.io/docs/markdown-features/code-blocks#line-highlighting)

#### Выделение текста

Для выделения заметок используйте `admonitions`, подробности доступны в [документации docusaurus](https://docusaurus.io/docs/markdown-features/admonitions), пример:

```
:::caution

Экспериментальная возможность, возможны ломающие изменения

:::
```

### Документы

#### Перекрестные ссылки

Для создания ссылок на другие страницы документации, проще всего использовать такую схему:

1. Берем путь до нужную страницы относительно папки `tools/docSite/tmp-docs`, например `get-started/overview`
1. Добавляем расширение `.md` к файлу, получается `get-started/overview.md`

Для добавления якоря надо использовать `#`, при этом учитывать, что якорь должен быть в lower case и все проблемы будут заменены на `-`.
Например, вот ссылка с якорем `### Some subtile` - `get-started/overview.md#some-subtitle`

### Sidebar

#### Добавление пункта меню

Меню генерируется автоматически, на основе файлов из папки `tools/docSite/tmp-docs`

#### Изменение заголовков или порядка категорий

Если нужно изменить порядок категорий, а каждая папка является категорией, в эту папку можно добавить файл `_category_.json`.
Параметр `position` отвечает за порядок, а `label` за заголовок категории.
Подробнее в [документации к Docusaurus](https://docusaurus.io/docs/sidebar/autogenerated#autogenerated-sidebar-metadata).

#### Изменение заголовков или порядка документации

Если нужно изменить порядок расположения документации в категории, надо использовать markdown метаданные.
Параметр `sidebar_position` отвечает за порядок, а `sidebar_label` за заголовок файла.
Подробнее в [документации к Docusaurus](https://docusaurus.io/docs/sidebar/autogenerated#autogenerated-sidebar-metadata).
